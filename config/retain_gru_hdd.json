{
    "name": "RETAIN HDD GRU",
    "seed": 3,
    "arch": {
        "type": "RETAIN_GRU",
        "args": {
            "n_feat": 13,
            "Wemb_size": 20,
            "n_gru_a": 1,
            "n_gru_b": 2,
            "gru_sizes": "[50, 80]",
            "fc_sizes": "[40]",
            "dropout": 0.3,
            "l1": 1e-05
        }
    },
    "dataloader": {
        "type": "H5DatasetNamed",
        "args": {
            "hdf5_source": "data/HDD_selected.h5",
            "valid_ratio": 0.1,
            "test_ratio": 0.01,
            "seed": 2
        }
    },
    "loss": "binary_crossentropy",
    "class_weight": 1,
    "metrics": [
        "binary_accuracy"
    ],
    "optimizer": {
        "type": "Adam",
        "args": {
            "lr": 1e-03,
            "decay": 1e-7,
            "amsgrad": true
        }
    },
    "callbacks": [
        {
            "name": "ROC",
            "type": "ROCMetric",
            "args": {
                "format": "",
                "target_far": 0.01,
                "max_iter": 10
            }
        },
        {
            "name": "ROC curve",
            "type": "ROCCurve",
            "args": {
                "format": "",
                "max_iter": 10,
                "min_FN": 0.001,
                "max_FN": 0.05,
                "n_steps": 40,
                "callback": "save_plot"
            }
        },
        {
            "name": "Contribution heatmap",
            "type": "ContributionHeatmapTensorboard",
            "args": {
                "format": "",
                "labels": [
                    "Reported Uncorrectable Errors'",
                    "SATA Downshift Errors'",
                    "Reallocated Sectors'",
                    "Current Pending Sectors'",
                    "Load Cycles'",
                    "Head Flying Hours'",
                    "Power On Hours'",
                    " Count'",
                    "Start/Stops'",
                    "Power Off Retracts'",
                    "Power Cycles'",
                    "Total LBA Written'",
                    "Total LBA Read"
                ],
                "callback": "save_images",
                "total_size": "20"
            }
        },
        {
            "name": "Model saver",
            "type": "ModelCheckpoint",
            "args": {
                "format": "checkpoints/cp-{epoch:03d}.ckpt",
                "save_weights_only": true,
                "verbose": 0
            }
        },
        {
            "name": "Best model",
            "type": "ModelCheckpoint",
            "args": {
                "format": "checkpoints/best-{epoch:03d}.ckpt",
                "monitor": "binary_accuracy",
                "save_best_only": true,
                "save_weights_only": true,
                "verbose": 0
            }
        },
        {
            "name": "Train-val accuracy/loss record",
            "type": "TensorBoard",
            "args": {
                "format": "",
                "histogram_freq": 0,
                "write_images": false,
                "profile_batch": 0
            }
        }
    ],
    "trainer": {
        "epochs": 200,
        "verbose": 0,
        "batch_size": 128
    },
    "continue": {
        "value": false,
        "args": {
            "epoch": 0,
            "weights": "checkpoints/cp-0.ckpt"
        }
    }
}
