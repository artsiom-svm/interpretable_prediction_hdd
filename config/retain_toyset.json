{
    "name": "RETAIN, toyset m=[2,4,6,8,10]",
    "seed": 3,
    "arch": {
        "type": "RETAIN_LSTM",
        "args": {
            "n_feat": 5,
            "Wemb_size": 30,
            "n_lstm_a": 1,
            "n_lstm_b": 1,
            "lstm_sizes": "[25, 25]",
            "fc_sizes": "[30]",
            "l1": 1e-03
        }
    },
    "dataloader": {
        "type": "H5DatasetNamed",
        "args": {
            "hdf5_source": "data/toyset.hdf5",
            "valid_ratio": 0.1,
            "test_ratio": 0.1,
            "seed": 2
        }
    },
    "loss": "binary_crossentropy",
    "class_weight": 2,
    "metrics": [
        "binary_accuracy"
    ],
    "optimizer": {
        "type": "Adam",
        "args": {
            "lr": 1e-03,
            "decay": 0,
            "amsgrad": true
        }
    },
    "callbacks": [
        {
            "name": "ROC",
            "type": "ROCMetric",
            "args": {
                "format": "",
                "target_far": 0.02,
                "max_iter": 10
            }
        },
        {
            "name": "ROC curve",
            "type": "ROCCurve",
            "args": {
                "format": "",
                "max_iter": 10,
                "min_FN": 0.001,
                "max_FN": 0.05,
                "n_steps": 40,
                "callback": "save_plot"
            }
        },
        {
            "name": "Contribution heatmap",
            "type": "ContributionHeatmapTensorboard",
            "args": {
                "format": "",
                "labels": [
                    "m=2",
                    "m=4",
                    "m=6",
                    "m=8",
                    "m=10"
                ],
                "callback": "save_images",
                "total_size": "10"
            }
        },
        {
            "name": "Model saver",
            "type": "ModelCheckpoint",
            "args": {
                "format": "checkpoints/cp-{epoch:03d}.ckpt",
                "save_weights_only": true,
                "verbose": 0
            }
        },
        {
            "name": "Best model",
            "type": "ModelCheckpoint",
            "args": {
                "format": "checkpoints/best-{epoch:03d}.ckpt",
                "monitor": "binary_accuracy",
                "save_best_only": true,
                "save_weights_only": true,
                "verbose": 0
            }
        },
        {
            "name": "Train-val accuracy/loss record",
            "type": "TensorBoard",
            "args": {
                "format": "",
                "histogram_freq": 1,
                "write_images": true,
                "profile_batch": 0
            }
        }
    ],
    "trainer": {
        "epochs": 30,
        "verbose": 1,
        "batch_size": 256
    },
    "continue": {
        "value": false,
        "args": {
            "epoch": 0,
            "weights": "checkpoints/cp-0.ckpt"
        }
    }
}
